---
import SiteLayout from '../../layouts/SiteLayout.astro';
import { getI18nResources } from '../../lib/i18n/resources.js';
import ProductsIndexSsg from '../../components/_astro/ssg/ProductsIndexSsg.jsx';
import {
  fetchProductsCategoryCardImagesForBuild,
  fetchProductsIndexCountsForBuild,
  fetchProductsPageSettingsForBuild,
} from '../../lib/sanity/build.js';

import { getProductsIndexMeta } from '../../lib/seo/productsMeta.js';

const resources = await getI18nResources('pl');
const initialProductCountsByCategory = await fetchProductsIndexCountsForBuild('pl');
const productsPageSettings = await fetchProductsPageSettingsForBuild();
const categoryCardImages = await fetchProductsCategoryCardImagesForBuild();

const meta = getProductsIndexMeta({ lang: 'pl' });
---

<SiteLayout
  lang="pl"
  title={meta.title}
  description={meta.description}
>
  <ProductsIndexSsg
    lang="pl"
    resources={resources}
    initialProductCountsByCategory={initialProductCountsByCategory}
    productsHeaderImage={productsPageSettings?.headerImage || null}
    categoryCardImages={categoryCardImages}
  />
</SiteLayout>
