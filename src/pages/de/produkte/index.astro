---
import SiteLayout from '../../../layouts/SiteLayout.astro';
import { getI18nResources } from '../../../lib/i18n/resources.js';
import ProductsIndexSsg from '../../../components/_astro/ssg/ProductsIndexSsg.jsx';
import {
  fetchProductsCategoryCardImagesForBuild,
  fetchProductsIndexCountsForBuild,
  fetchProductsPageSettingsForBuild,
} from '../../../lib/sanity/build.js';

const resources = await getI18nResources('de');
const initialProductCountsByCategory = await fetchProductsIndexCountsForBuild('de');
const productsPageSettings = await fetchProductsPageSettingsForBuild();
const categoryCardImages = await fetchProductsCategoryCardImagesForBuild();
---

<SiteLayout
  lang="de"
  title="Produkte – ROJEK | Fenster, Türen, Tore & Rollläden"
  description="ROJEK Produkte: Fenster, Türen, Garagentore und Rollläden. Kategorien ansehen und passende Lösung wählen."
>
  <ProductsIndexSsg
    lang="de"
    resources={resources}
    initialProductCountsByCategory={initialProductCountsByCategory}
    productsHeaderImage={productsPageSettings?.headerImage || null}
    categoryCardImages={categoryCardImages}
  />
</SiteLayout>
